Get-ADComputer -Filter * -Properties * | 
    Select-Object `
        Name,
        DNSHostName,
        OperatingSystem,
        OperatingSystemVersion,
        IPv4Address,
        Enabled,
        LastLogonDate,
        @{Name="DaysSinceLastLogon";Expression={
            if($_.LastLogonDate){
                (New-TimeSpan -Start $_.LastLogonDate -End (Get-Date)).Days
            } else {
                "Never"
            }
        }},
        @{Name="Status";Expression={
            if(-not $_.Enabled){
                "Disabled"
            } elseif($_.LastLogonDate -eq $null){
                "Never Logged On"
            } elseif((New-TimeSpan -Start $_.LastLogonDate -End (Get-Date)).Days -gt 90){
                "Inactive (90+ days)"
            } elseif((New-TimeSpan -Start $_.LastLogonDate -End (Get-Date)).Days -gt 30){
                "Inactive (30+ days)"
            } else {
                "Active"
            }
        }},
        Description,
        whenCreated,
        DistinguishedName |
    Export-Csv -Path "C:\Temp\AD_Computers_Complete.csv" -NoTypeInformation


############## simple

# Export ALL AD Computers with ALL Properties
# Windows Server 2016

Get-ADComputer -Filter * -Properties * | 
    Export-Csv -Path "C:\Temp\AD_Computers_Complete.csv" -NoTypeInformation

Write-Host "All computers exported to C:\Temp\AD_Computers_Complete.csv" -ForegroundColor Green


########### Fix 3: Use Alternative Syntax (Most Common Fix)

# Use quotes around the filter
Get-ADComputer -Filter "*" -Properties * | 
    Export-Csv -Path "C:\Temp\AD_Computers_Complete.csv" -NoTypeInformation

Write-Host "Done!" -ForegroundColor Green


################# Fix 5: Use SearchBase Instead


# Specify your domain controller explicitly
Get-ADComputer -Filter * -Properties * -Server "DC01.yourdomain.local" | 
    Export-Csv -Path "C:\Temp\AD_Computers_Complete.csv" -NoTypeInformation

# Replace "DC01.yourdomain.local" with your actual DC name
