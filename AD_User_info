

# Simple AD Users Export Script
# Windows Server 2016 Compatible

# Get all users and export to CSV
Get-ADUser -Filter * -Properties DisplayName, EmailAddress, Enabled, Department, Title | 
    Select-Object SamAccountName, DisplayName, EmailAddress, Department, Title, Enabled | 
    Export-Csv -Path "C:\Temp\AD_Users.csv" -NoTypeInformation

Write-Host "Users exported to C:\Temp\AD_Users.csv" -ForegroundColor Green



#####################

# Export ALL AD Users with ALL Properties
# Windows Server 2016

Get-ADUser -Filter * -Properties * | 
    Export-Csv -Path "C:\Temp\AD_Users_Complete.csv" -NoTypeInformation

Write-Host "All users with all properties exported to C:\Temp\AD_Users_Complete.csv" -ForegroundColor Green

#############

# Export users with commonly used properties (organized)

Get-ADUser -Filter * -Properties * | 
    Select-Object `
        # Basic Info
        SamAccountName,
        UserPrincipalName,
        DisplayName,
        GivenName,
        Surname,
        Name,
        Description,
        
        # Contact Info
        EmailAddress,
        OfficePhone,
        MobilePhone,
        HomePhone,
        Fax,
        
        # Location
        Office,
        StreetAddress,
        City,
        State,
        PostalCode,
        Country,
        
        # Organization
        Title,
        Department,
        Company,
        Manager,
        EmployeeID,
        EmployeeNumber,
        
        # Account Status
        Enabled,
        LockedOut,
        PasswordExpired,
        PasswordNeverExpires,
        PasswordNotRequired,
        CannotChangePassword,
        
        # Dates
        LastLogonDate,
        PasswordLastSet,
        AccountExpirationDate,
        whenCreated,
        whenChanged,
        LastBadPasswordAttempt,
        
        # Additional
        HomeDirectory,
        HomeDrive,
        ProfilePath,
        ScriptPath,
        DistinguishedName,
        CanonicalName,
        ObjectGUID,
        SID |
    Export-Csv -Path "C:\Temp\AD_Users_Organized.csv" -NoTypeInformation

Write-Host "Done! Exported to C:\Temp\AD_Users_Organized.csv" -ForegroundColor Green


#######################
